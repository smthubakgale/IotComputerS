<!DOCTYPE html>

<html lang="en" xmlns="http://www.w3.org/1999/xhtml">
<head>

    <!--    Title    -->
    <title> Computer Systems - ThinkSpeak IoT </title>
    <link rel="shortcut icon" type="image/png" href="assets/img/logo.ico" />

    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>

    <script>
        var state = false;
        function start() {
            $("#stp").css("display", "block");
            $("#ref").css("display", "block");
            $("#str").css("display", "none");
            state = true;
        }
        function refresh() {
            if (state) {
                var a = $("#ifr").html();
                $("#ifr").html(a);
            }
        }
        function stop() {
            $("#stp").css("display", "none");
            $("#ref").css("display", "none");
            $("#str").css("display", "block");
            state = false;
        }
        $(window).on("load", function () {
            setInterval(function () { refresh(); }, 10000);
        })
    </script>
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.6.0/dist/leaflet.css" integrity="sha512-xwE/Az9zrjBIphAcBb3F6JVqxf46+CDLwfLMHloNu6KEQCAWi6HcDUbeOfBIptF7tcCzusKFjFw2yuvEpDL9wQ==" crossorigin="" />
</head>
<body oncontextmenu="return false">
    <script>
        document.onkeydown = function (e) {
            if (event.keyCode == 123) {
                return false;
            }
            if (e.ctrlKey && e.shiftKey && e.keyCode == 'I'.charCodeAt(0)) {
                return false;
            }
            if (e.ctrlKey && e.shiftKey && e.keyCode == 'C'.charCodeAt(0)) {
                return false;
            }
            if (e.ctrlKey && e.shiftKey && e.keyCode == 'J'.charCodeAt(0)) {
                return false;
            }
            if (e.ctrlKey && e.keyCode == 'U'.charCodeAt(0)) {
                return false;
            }
        }
    </script>
    <main>

        <!--1. Banner-->
        <section class="s-banner">
            <div style="position:relative; width:100%; margin-top:40px;">
                <img src="assets/img/banner.jpg" style="width:100%; height:448px;" />
                <div style="position: absolute; width: 100%; top: 0px; left: 0px; height: 448px; color: white; background-image: linear-gradient(to right, rgba(34, 86, 123,1), rgba(0,0,0,0.3)); ">
                    <div style="margin-top: 84px; margin-left: 15px; cursor: pointer; font-size: 18px; font-weight: 600;">
                        Smart Sensor Dashboard
                    </div>
                    <div style="margin-top: 28px; margin-left: 15px; cursor: pointer; font-size: 30px; font-weight: 800; ">
                        Internet of Things <br />
                        for Smart Devices
                    </div>
                    <div style="margin-top: 17px; margin-left: 15px; cursor: pointer; font-size: 17px; font-weight: 600; ">
                        Understanding the working a smart device

                    </div>
                    <div style="margin-top: 34px; margin-left: 15px; cursor:pointer; font-size: 18px; font-weight: 600; padding: 12px; border-radius:8px; text-align:center; width: 190px; background-color: #EB4343; ">
                        Meet the Team
                    </div>
                </div>
            </div>
        </section>
        <!--1. About Us-->
        <section>
            <style>
                .abt {
                    display: flex;
                }

                    .abt .b {
                        margin: auto;
                        width: 90%;
                    }

                .abt2 {
                    display: flex;
                    background-color: rgba(228, 237, 244,0.8);
                }

                    .abt2 .b {
                        margin: auto;
                        width: 90%;
                    }
                /*Web*/
                @media not screen and (max-width: 1000px) {
                    .abt {
                        flex-direction: row-reverse;
                    }

                    .abt2 {
                        flex-direction: row;
                    }

                    .grp {
                        width: 100%;
                        height: 260px;
                    }
                }
                /*Web*/
                @media screen and (max-width: 1000px) {
                    .abt {
                        flex-direction: column-reverse;
                    }

                    .abt2 {
                        flex-direction: column-reverse;
                    }

                    .grp {
                        width: 100%;
                        height: 500px;
                    }
                }
            </style>
            <div class="abt s-about-me">
                <div style="flex:1; font-weight:500; font-size:15px;">
                    <div class="b" style="padding-top:15px;  font-size:16px;">
                        We are creating a website that can read and display the data of at least one smart
                        environmental sensor.<br>
                        This is done so that it can be able to read/obtain the data from the online smart sensor and show
                        the data live in graphs on our website (not Thingspeak).<br>
                        For this practical we must be able to collect the live data and create graphs with the live data from the smart sensor.
                        The user shall be able to see live information of the smart device on the website.

                    </div>
                </div>
                <div style="flex:1;">
                    <div style="width:100%; min-height:280px; padding-top:5px; padding-bottom:10px;">
                        <div style="width:90%; position:relative; margin:auto; margin-top:15px;">
                            <img src="assets/img/abt.jpg" style="width:100%;" />
                            <div style="position: absolute; height: 100%; top: 0px; left: 0px; background-image: linear-gradient(to right,rgba(30, 86, 128,0.8), rgba(30, 86, 128,0.5), rgba(30, 86, 128,0.3)); width: 100%; color: #717A7F; ">
                                <div style="display: flex; margin-left:10%; margin-top:50px; font-size:30px; font-weight:900;">
                                    <div style="width:30px; margin-left:5px; margin-right:5px; padding-top:12px;">
                                        <hr style="border:none; border-bottom:solid white 5px;" />
                                    </div>
                                    <div style="color: white;">
                                        About
                                    </div>
                                </div>
                                <div style="margin-left:12%; color:white; font-size:40px; font-weight:900;">
                                    PRACTICAL 1
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!--2. Live Graphs-->
        <section>
            <div>
                <div style="display: flex; padding-top: 10px; border-top: solid #184E6F 2px;">
                    <div style="color: #EB4343; font-weight:900; font-size:28px;">
                        Live :
                    </div>
                    <style>
                        .btn {
                            cursor: pointer;
                            font-size: 18px;
                            font-weight: 600;
                            padding: 8px;
                            border-radius: 8px;
                            text-align: center;
                            width: 150px;
                            background-color: #EB4343;
                            color: white;
                            border: solid darkblue 2px;
                        }
                    </style>
                    <div style="flex:1;"></div>
                    <div>
                        <button class="btn" id="str" style="margin-right:15px;" onclick="start();"> Start </button>
                    </div>
                    <div>
                        <button class="btn" id="ref" style="margin-right:15px; display:none;" start="false" onclick="refresh()"> Refresh </button>
                    </div>
                    <div>
                        <button class="btn" id="stp" style="display:none;" onclick="stop();"> Stop </button>
                    </div>
                </div>
            </div>
            <div>
                <div style="width: 100%; text-align:center; padding-top:8px; color: #1E5680; margin:auto; font-size: 30px; font-weight: 700;">
                    <span id="snsttl">Sensor 1</span> Readings
                </div>
                <div style="width: 90%; color: #717A7F; font-weight:500; font-size:17px; margin:auto; text-align: center;">

                </div>
                <div class="abt" id="ifr">
                    <div style="flex:1; padding:5px;">
                        <iframe class="grp grp1" style="border: 1px solid #cccccc; margin:auto;" src="https://api.thingspeak.com/channels/1708546/charts/2?results=720&dynamic=true&update=15"></iframe>
                    </div>
                    <div style="flex:1; padding:5px;">
                        <iframe class="grp grp2" style="border: 1px solid #cccccc; margin:auto;" src="https://api.thingspeak.com/channels/1708546/charts/1?results=720&dynamic=true&update=15"></iframe>
                    </div>
                </div>
            </div>

        </section>

        <!--3. Map Sensors -->
        <section>
            <div style="padding-top: 10px; padding-bottom:30px; border-top: solid #FF0000 2px;">
                <div style="width: 300px; padding-top: 8px; padding-bottom:16px; color: #FF0000; margin: auto; font-size: 30px; font-weight: 700;">
                    Map Sensors
                </div>
                <div class="mpc" style="overflow-x:scroll">
                    <div class="mps" style="border: solid #FF0000 1px; margin-bottom: 20px; background: url(assets/img/map.jpeg) no-repeat ; background-size: cover; ">

                    </div>
                </div>
                <script>
                    $(document).ready(function ()
                    {
                        var cont = false; 
                        $('.mps').mousemove(function (event)
                        {
                            cont = true;

                        }).mouseleave(function (event)
                        {
                            cont = false;

                        }).mousedown(function (event)
                        {
                            if (cont)
                            {
                                var x = 100 * (event.pageX - $(this).offset().left) / $(this).outerWidth();
                                var y = 100 * (event.pageY - $(this).offset().top) / $(this).outerWidth();

                                var s = [[21.23, 28.68], [32.47, 20.91], [54.96, 34.04], [82.33, 25.31]];
                                var sn = 1;

                                $.each(s, (k, item) =>
                                {
                                    var x_min = item[0] - 1;
                                    var x_max = item[0] + 1;

                                    var y_min = item[1] - 1;
                                    var y_max = item[1] + 1;
                                     
                                    if (x_min < x && x < x_max && y_min < y && y < y_max) {
                                        sn = k + 1;
                                        cnt = false;
                                    }
                                })


                                var urls = ["https://api.thingspeak.com/channels/1708546/fields/1.json?results=2", "https://api.thingspeak.com/channels/1737929/fields/1.json?results=2",
                                    "https://api.thingspeak.com/channels/1738066/fields/1.json?results=2", "https://api.thingspeak.com/channels/1738082/fields/1.json?results=2"];

                                var item = urls[sn - 1];
                                $.ajax({
                                    async: false,
                                    type: "GET",
                                    url: item,
                                    contentType: "application/json;",
                                    success: function (resp)
                                    {
                                        var id = resp.channel.id;
                                        var name = resp.channel.name; 
                                        // Load Graphs

                                        var tmp = 'https://api.thingspeak.com/channels/' + id + '/charts/2?results=720&dynamic=true&update=15'
                                        var hmd = 'https://api.thingspeak.com/channels/' + id + '/charts/1?results=720&dynamic=true&update=15'

                                        $("#snsttl").html(name);
                                        $("#ifr").find(".grp1").attr("src", tmp);
                                        $("#ifr").find(".grp2").attr("src", hmd);

                                        var h = $("#ifr").html();
                                        $("#ifr").html(h);

                                        $([document.documentElement, document.body]).animate({
                                            scrollTop: $("#snsttl").offset().top - 20
                                        }, 250);
                                        // ---------- 
                                    },
                                    error: function (response)
                                    {
                                        alert("error");
                                    }
                                });
                            }
                        });
                    });
                </script>
                <style>

                    .mpc , #map {
                        width: 90%;
                        margin: auto; 
                    }
                    .mps{
                        height:400px;
                        width:800px;
                        margin:auto;
                    }
                    /*Web*/
                    @media not screen and (max-width: 1000px) {
                        .mpc, #map {
                            height: 80vh;
                        }
                    }
                    /* Mobile */
                    @media screen and (max-width: 1000px) {
                        .mpc, #map {
                            height: 400px;
                        }
                    }
                </style>
                <div id="map" >

                </div>
            </div>

        </section>

        <!--4. About Us Tab-->
        <section>
            <div style="width: 100%; background-color: #E4EEF4; padding-top: 5px; padding-bottom: 5px; ">
                <div style="width: 300px; padding-top:8px; color: #1E5680; margin:auto; font-size: 24px; font-weight: 700;">
                    Member Details
                </div>
                <div style="width: 90%; color: #717A7F; font-weight:500; font-size:17px; margin:auto; text-align: center;">

                </div>

                <div class="abt2">
                    <div style="flex: 2;padding: 15px;  ">
                        <div class="cn" style="border-radius:15px; display:flex; font-weight:600; min-height:132px; background-color:white; padding:30px; ">
                            <div class="cntc"></div>
                            <div>
                                <div style="font-weight: 700; font-size: 18px; color: #1E5680">
                                    <span style="color: #EB4343"> Mr</span> Skhosana RT
                                    <div style="width:40px; border:none; border-bottom:solid red 2px;"></div>
                                </div>
                                <div style="padding-top:10px;">
                                    Surname : Skhosana <br />
                                    Names : <br />
                                    <span class="fa fa-minus lv2"></span> Robert <br />
                                    <span class="fa fa-minus lv2"></span> Thokozani
                                </div>
                                <div style="padding-top:10px;">
                                    Student No : 218016979
                                </div>
                            </div>
                            <div style="flex:1;"></div>
                        </div>
                    </div>
                    <div style="flex:1; padding-right:10px;">
                        <div style="width:300px; margin:auto; height: 300px; padding-top:15px; padding-bottom:15px; ">
                            <img src="assets/img/robert.jpeg" style="width: 300px; height: 300px; image-orientation: from-image; border: solid #1E5680 2px; border-radius: 15px; " />
                        </div>
                    </div>
                </div>
                <div class="abt">
                    <div style="flex: 2;padding: 15px;  ">
                        <div class="cn" style="border-radius:15px; display:flex; font-weight:600; min-height:132px; background-color:white; padding:30px; ">
                            <div class="cntc"></div>
                            <div>
                                <div style="font-weight: 700; font-size: 18px; color: #1E5680">
                                    <span style="color: #EB4343"> Mr</span> Mahlare CK
                                    <div style="width:40px; border:none; border-bottom:solid red 2px;"></div>
                                </div>
                                <div style="padding-top:10px;">
                                    Surname : Mahlare <br />
                                    Names : <br />
                                    <span class="fa fa-minus lv2"></span> Bonny <br />
                                    <span class="fa fa-minus lv2"></span> Crossborn
                                </div>
                                <div style="padding-top:10px;">
                                    Student No : 216008649
                                </div>
                            </div>
                            <div style="flex:1;"></div>
                        </div>
                    </div>
                    <div style="flex:1; padding-right:10px;">
                        <div style="width:300px; margin:auto; height: 300px; padding-top:15px; padding-bottom:15px; ">
                            <img src="assets/img/mahlare.jpeg" style="width: 300px; height: 300px; image-orientation: from-image; border: solid #1E5680 2px; border-radius: 15px; " />
                        </div>
                    </div>
                </div>
                <div class="abt2">
                    <div style="flex: 2;padding: 15px;  ">
                        <div class="cn" style="border-radius:15px; display:flex; font-weight:600; min-height:132px; background-color:white; padding:30px; ">
                            <div class="cntc"></div>
                            <div>
                                <div style="font-weight: 700; font-size: 18px; color: #1E5680">
                                    <span style="color: #EB4343"> Mr</span> NTAI LI
                                    <div style="width:40px; border:none; border-bottom:solid red 2px;"></div>
                                </div>
                                <div style="padding-top:10px;">
                                    Surname : NTAI <br />
                                    Names : <br />
                                    <span class="fa fa-minus lv2"></span> LERATO
                                </div>
                                <div style="padding-top:10px;">
                                    Student No : 217070233
                                </div>
                            </div>
                            <div style="flex:1;"></div>
                        </div>
                    </div>
                    <div style="flex:1; padding-right:10px;">
                        <div style="width:300px; margin:auto; height: 300px; padding-top:15px; padding-bottom:15px; ">
                            <img src="assets/img/lavas.jpeg" style="width: 300px; height: 300px; image-orientation: from-image; border: solid #1E5680 2px; border-radius: 15px; " />
                        </div>
                    </div>
                </div>
                <div class="abt">
                    <div style="flex: 2;padding: 15px;  ">
                        <div class="cn" style="border-radius:15px; display:flex; font-weight:600; min-height:132px; background-color:white; padding:30px; ">
                            <div class="cntc"></div>
                            <div>
                                <div style="font-weight: 700; font-size: 18px; color: #1E5680">
                                    <span style="color: #EB4343"> Mr</span> Mbatha L
                                    <div style="width:40px; border:none; border-bottom:solid red 2px;"></div>
                                </div>
                                <div style="padding-top:10px;">
                                    Surname : Mbatha <br />
                                    Names : <br />
                                    <span class="fa fa-minus lv2"></span> Lindani
                                </div>
                                <div style="padding-top:10px;">
                                    Student No : 218077768
                                </div>
                            </div>
                            <div style="flex:1;"></div>
                        </div>
                    </div>
                    <div style="flex:1; padding-right:10px;">
                        <div style="width:300px; margin:auto; height: 300px; padding-top:15px; padding-bottom:15px; ">
                            <img src="assets/img/mbatha L.jpg" style="width: 300px; height: 300px; image-orientation: from-image; border: solid #1E5680 2px; border-radius: 15px; " />
                        </div>
                    </div>
                </div>
            </div>
        </section>

    </main>

    <script src="https://unpkg.com/leaflet@1.6.0/dist/leaflet.js" integrity="sha512-gZwIG9x3wUXg2hdXF6+rVkLF/0Vi9U8D2Ntg4Ga5I5BZpVkVxlJWbSQtXPSiUTtC0TjtGOmxa1AJPuV0CPthew==" crossorigin=""></script>
 
    <script>  
     // Create Map
        const map = L.map('map', {
            center: [-26.1936538398, 28.056508994 ], // replace [-30.5595, 22.9375] with  [-26.210555555556 , 27.788888888889]
            zoom: 16
        });

        L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', { attribution: '&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors' }).addTo(map);
        // Add Marker 
        $(window).on("load", function ()
        {
            var urls = ["https://api.thingspeak.com/channels/1708546/fields/1.json?results=2", "https://api.thingspeak.com/channels/1737929/fields/1.json?results=2",
                "https://api.thingspeak.com/channels/1738066/fields/1.json?results=2", "https://api.thingspeak.com/channels/1738082/fields/1.json?results=2"];

            var pos = [[-26.1919538398, 28.056508994], [-26.194853898, 28.056508994], [-26.194853898, 28.054508994], [-26.193053898, 28.05508994]];

            $.each(urls, (k, item) => {
                $.ajax({
                    async: false,
                    type: "GET",
                    url: item,
                    contentType: "application/json;",
                    success: function (resp)
                    {
                        var id = resp.channel.id;
                        var name = resp.channel.name;
                        var lat = parseInt(resp.channel.latitude);
                        var lon = parseInt(resp.channel.longitude);
                        // Add Marker

                        L.marker( pos[k] , {  // replace pos[k] with [lat , lon]
                            icon: new L.DivIcon({
                                className: 'my-div-icon',
                                html: '<div style="cursor:pointer;" name="sensor1" onclick="loadSensor(this)" >'
                                    + '<img style="width:30px; height:30px; " src="assets/img/sensor.svg"/>' +
                                    '<div class="sns" style="color:red; font-size:10px; font-weight:bold;" > '+name+'</div>'
                                    + '<div class="temp" style="display:none"> https://api.thingspeak.com/channels/'+ id +'/charts/2?results=720&dynamic=true&update=15 </div>'
                                    + '<div class="humd" style="display:none"> https://api.thingspeak.com/channels/' + id +'/charts/1?results=720&dynamic=true&update=15 </div>'
                                    + '</div>'
                            })
                        }).addTo(map);
                        // ---------- 
                    },
                    error: function (response) {
                        alert("error");
                    }
                });
            })

        })
        //
    </script>
    <script>
        function loadSensor(tag)
        {
            var temp = $(tag).find(".temp").html();
            var humd= $(tag).find(".humd").html();
            var sns= $(tag).find(".sns").html(); 

            $("#snsttl").html(sns);
            $("#ifr").find(".grp1").attr("src", temp);
            $("#ifr").find(".grp2").attr("src", humd);

            var h = $("#ifr").html();
            $("#ifr").html(h);

            $([document.documentElement, document.body]).animate({
                scrollTop: $("#snsttl").offset().top - 20
            }, 250);
        }
    </script>

</body>
</html>
